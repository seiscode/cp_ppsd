# PPSD 参数测试报告

**测试日期**: 2025-06-04  
**测试环境**: Linux 6.11.0-26-generic, Python 3.12, ObsPy  
**测试数据**: BJ.DAX.00.BHZ.20250324000001.mseed (24小时连续数据, 8,640,193样本点)  
**采样率**: 100Hz  
**数据质量**: 连续无间隙  

## 📋 测试概述

本次测试系统性地评估了6个关键PPSD计算参数对结果的影响：
- `ppsd_length`: 时间窗口长度
- `overlap`: 窗口重叠比例  
- `period_limits`: 周期范围
- `period_smoothing_width_octaves`: 周期平滑宽度
- `period_step_octaves`: 周期步长
- `db_bins`: dB分箱设置

## 🔬 详细测试结果

### 1. ppsd_length (时间窗口长度) 测试

**测试目的**: 评估时间窗口长度对时间分辨率的影响

| 参数值 | 窗口长度 | 生成时间段数 | 计算时间 | 时间分辨率 |
|--------|----------|--------------|----------|------------|
| `1800` | 0.5小时 | **95** | ~43s | 高 |
| `3600` | 1.0小时 | **47** | ~30s | 标准 |

**关键发现**:
- 窗口长度减半 → 时间段数翻倍
- 更短窗口提供更高时间分辨率，但增加计算负担
- 对于24小时数据，1小时窗口是性能与精度的良好平衡

### 2. overlap (窗口重叠比例) 测试

**测试目的**: 评估重叠对统计平滑性和计算量的影响

| 参数值 | 重叠比例 | 生成时间段数 | 计算时间 | 统计平滑性 |
|--------|----------|--------------|----------|------------|
| `0.0` | 无重叠 | **24** | ~15s | 低 |
| `0.5` | 50%重叠 | **47** | ~30s | 标准 |
| `0.75` | 75%重叠 | **93** | ~46s | 高 |

**关键发现**:
- 重叠比例与时间段数呈正相关
- 高重叠提供更平滑的统计特性
- 75%重叠几乎使计算量翻倍
- 50%重叠是常用的标准配置

### 3. period_limits (周期范围) 测试

**测试目的**: 评估频率覆盖范围对计算的影响

| 参数值 | 频率范围 | 生成时间段数 | 频率覆盖 | 影响 |
|--------|----------|--------------|----------|--------|
| `[0.01, 1000.0]` | 0.001-100Hz | **47** | 超宽频 | 完整覆盖 |
| `[0.1, 100.0]` | 0.01-10Hz | **47** | 窄频 | 限制高低频 |

**关键发现**:
- 周期范围主要影响频域覆盖，不影响时间分段数
- 超宽频范围适合全面分析
- 窄频范围可聚焦特定频段，减少存储需求

### 4. period_smoothing_width_octaves (周期平滑宽度) 测试

**测试目的**: 评估频率域平滑对分辨率的影响

| 参数值 | 平滑宽度 | 生成时间段数 | 频率分辨率 | 计算影响 |
|--------|----------|--------------|------------|----------|
| `1.0` | 1倍频程 | **47** | 标准 | 标准 |
| `0.5` | 0.5倍频程 | **47** | 精细 | 轻微增加 |

**关键发现**:
- 平滑宽度影响频率分辨率，不影响时间分段
- 更细的平滑提供更高频率分辨率
- 对计算性能影响很小

### 5. period_step_octaves (周期步长) 测试

**测试目的**: 评估频率采样密度对精度的影响

| 参数值 | 步长 | 生成时间段数 | 频率采样点数 | 存储影响 |
|--------|------|--------------|--------------|----------|
| `0.125` | 1/8倍频程 | **47** | 高密度 | 大文件 |
| `0.25` | 1/4倍频程 | **47** | 标准密度 | 标准文件 |

**关键发现**:
- 步长影响频率轴的采样密度
- 更细步长提供更精细的频谱，但增加存储需求
- 不影响时间分段计算

### 6. db_bins (dB分箱) 测试

**测试目的**: 评估振幅域分辨率对存储的影响

| 参数值 | dB范围 | 步长 | 文件大小 | 分辨率 |
|--------|--------|------|----------|--------|
| `[-200.0, -50.0, 0.25]` | 150dB | 0.25dB | ~222KB | 精细 |
| `[-180.0, -80.0, 0.5]` | 100dB | 0.5dB | ~222KB | 粗糙 |

**关键发现**:
- dB分箱主要影响振幅域分辨率
- 对文件大小影响相对较小（本测试中差异不明显）
- 不影响时间分段计算

## 📊 性能影响分析

### 时间段数影响因子（按重要性排序）:
1. **ppsd_length** - 直接决定基础分段数
2. **overlap** - 成倍影响最终时间段数
3. 其他参数 - 主要影响频域/振幅域特性

### 计算性能关键指标:
- **最快配置**: `ppsd_length=3600, overlap=0.0` → 24段, ~15s
- **标准配置**: `ppsd_length=3600, overlap=0.5` → 47段, ~30s  
- **高精度配置**: `ppsd_length=1800, overlap=0.75` → 95段, ~46s

## 🎯 配置建议

### 根据应用场景的推荐配置:

#### 1. 快速预览分析
```toml
ppsd_length = 3600          # 1小时窗口
overlap = 0.0               # 无重叠
period_limits = [0.1, 100.0]  # 窄频带
period_step_octaves = 0.25  # 粗糙步长
```

#### 2. 标准科学分析 (推荐)
```toml
ppsd_length = 3600          # 1小时窗口
overlap = 0.5               # 50%重叠
period_limits = [0.01, 1000.0]  # 全频带
period_smoothing_width_octaves = 1.0
period_step_octaves = 0.125
db_bins = [-200.0, -50.0, 0.25]
```

#### 3. 高精度研究分析
```toml
ppsd_length = 1800          # 0.5小时窗口
overlap = 0.75              # 75%重叠
period_limits = [0.01, 1000.0]  # 全频带
period_smoothing_width_octaves = 0.5  # 精细平滑
period_step_octaves = 0.125
db_bins = [-200.0, -50.0, 0.25]
```

## 🔍 重要发现总结

1. **时间分辨率控制**: `ppsd_length`和`overlap`是控制时间分辨率的关键参数
2. **计算复杂度**: 时间段数是最重要的性能影响因子
3. **频域参数独立性**: 频域参数主要影响频谱特性，不影响时间分割
4. **存储优化**: dB分箱对文件大小影响相对较小
5. **配置平衡**: 标准配置提供了良好的性能-精度平衡

## 📝 测试环境详情

- **硬件**: Intel CPU, 16GB RAM
- **软件**: 
  - Python 3.12
  - ObsPy latest
  - NumPy/SciPy
- **数据特征**:
  - 台站: BJ.DAX.00.BHZ
  - 时间: 2025-03-24 16:00-2025-03-24 16:00 (24小时)
  - 采样率: 100Hz
  - 数据质量: 连续，无间隙
  - 总样本: 8,640,193点

## 📈 后续测试建议

1. **不同数据质量测试**: 测试含间隙数据的参数敏感性
2. **多台站对比**: 评估参数对不同台站/仪器的影响
3. **长期数据测试**: 测试月度/年度数据的参数优化
4. **内存使用分析**: 分析不同参数配置的内存占用
5. **并行处理测试**: 评估参数对并行计算效率的影响

---

**报告生成**: 自动化测试系统  
**版本**: v1.0  
**最后更新**: 2025-06-04 