---
description: 
globs: 
alwaysApply: false
---
# 知识库实施计划 (Knowledge Base Implementation Plan)

本文档用于追踪 `cp_ppsd` 项目知识库的各项文档创建与完善进度。

## 计划条目与状态

| 序号 | 文档                               | 计划文件名                      | 状态    | 负责人 | 备注与概要                                       |
|------|------------------------------------|---------------------------------|---------|--------|---------------------------------------------------|
| 1    | 项目概述                           | `00_PROJECT_OVERVIEW.md`        | **完成** |        | 项目目标、范围、整体架构图和组件说明。             |
| 2    | 开发环境搭建                       | `01_DEVELOPMENT_ENVIRONMENT.md` | **完成** |        | Python版本、依赖管理、虚拟环境、必要工具。         |
| 3    | 编码规范                           | `02_CODING_STANDARDS.md`        | **完成** |        | 代码风格、审查流程、分支策略、提交规范。             |
| 4    | 测试指南                           | `03_TESTING_GUIDELINES.md`      | **完成** |        | 测试策略、编写与运行测试、覆盖率目标。             |
| 5    | 常见问题解答                       | `04_TROUBLESHOOTING_FAQ.md`     | **完成** |        | 开发和使用中的常见问题与解决方案。                 |
| 6    | 贡献指南                           | `05_CONTRIBUTING.md`          | **完成** |        | 代码/文档贡献流程、Bug报告、功能请求、行为准则。   |
| 7    | 部署流程                           | `06_DEPLOYMENT_PROCESS.md`      | **待办** |        | (如果适用) 应用构建和部署流程。                    |
| 8    | 术语表                             | `07_GLOSSARY.md`                | **待办** |        | 项目特定术语、地球物理学概念定义。                 |
| 9    | 产品需求文档：PDF计算软件 (现有)     | `产品需求文档：PDF计算软件.md`    | **完成** |        | 核心功能文档，持续维护。                             |
| 10   | 项目需求文档 (现有, 根目录)      | `../项目需求文档.md`            | **完成** |        | 项目整体需求和目标，可能需要同步更新。               |
| 11   | 知识库索引 (README)                | `README.md`                     | **完成** |        | 知识库入口和索引，随文档增删更新。                 |
| 12   | 知识库实施计划 (本文档)            | `implementation-plan.mdc`       | **完成** |        | 追踪知识库文档创建进度。                           |

---

**状态说明:**
-   **待办 (To Do)**: 计划中，尚未开始。
-   **进行中 (In Progress)**: 正在编写或修订。
-   **待审核 (Pending Review)**: 初稿完成，等待审核。
-   **完成 (Done)**: 已审核并整合到知识库中。
-   **暂缓 (On Hold)**: 暂时搁置。

**更新指南:**
-   当开始处理一个条目时，请将状态更新为"进行中"并指定负责人。
-   完成初稿后，更新状态为"待审核"。
-   文档审核通过并合并后，更新状态为"完成"，并在"备注与概要"中添加简短的完成说明或关键内容摘要（例如，"Done - 2023-10-27: 初步完成了Python版本和虚拟环境设置说明。"）。

## 项目变更记录

### 2024年变更
- **2024-05-26**: 主入口脚本重命名 - 将 `main.py` 重命名为 `run_cp_ppsd.py`，更新了所有相关文档和配置文件中的使用说明。项目现在采用模块化结构：`run_cp_ppsd.py` 作为主入口，`cp_ppsd/cp_psd.py` 作为核心处理模块。

### 2025年变更
- **2025-05-27**: 输出文件名时间信息优化 - 修改了文件名生成逻辑，使输出文件名中的时间信息来自MiniSEED数据的开始时间，而不是处理时间。这一改进使文件名能够准确反映数据的实际时间范围，便于数据管理和分析。主要修改包括：
  - 修改 `_generate_filename` 方法，添加 `data_starttime` 参数
  - 在 `_process_trace` 中传递 `trace.stats.starttime` 作为数据开始时间
  - 在 `_create_plot` 中从PPSD对象获取数据时间用于绘图文件名
  - 更新配置文件注释，明确说明时间信息来源

- **2025-01-XX**: 产品说明文档深度优化 - 对 `产品说明文档：PDF计算软件.md` 进行了全面的技术内容深化，主要更新包括：
  - **3.3节 PPSD分箱概念详解**: 新增详细的分箱工作原理、PPSD矩阵构建、分箱精度影响分析
  - **3.3.7-3.3.8节 图像解读详解**: 新增水平条带和垂直条带的详细物理意义解释，包括稳定噪声源和宽频噪声事件的识别
  - **3.4节 PSD平滑窗口宽度概念详解**: 新增倍频程概念、平滑必要性、不同宽度值影响对比等深度技术内容
  - **3.5节 period_step_octaves参数详解**: 完全重写，从地震学物理角度深入解释频率网格构建原理、PPSD计算参与过程、物理意义和实际应用指导
  - 所有新增内容均避免程序代码解释，专注于地震学物理原理和实际应用价值

- **2025-01-XX**: NPZ合并策略参数优化 - 将 `npz_merge_strategy` 参数从字符串类型改为布尔值类型，简化配置：
  - **参数类型变更**: 从 `"individual"/"merge_by_channel"` 改为 `false/true`
  - **false**: 每个NPZ文件单独生成一张图（默认行为）
  - **true**: 将同一台网、台站、位置、通道的多个NPZ文件合并到一张图中
  - 更新了产品说明文档和实际配置文件中的所有相关描述和示例

- **2025-05-27**: skip_on_gaps参数设置指南 - 在产品说明文档的"6. 常见问题与解决方案"章节新增6.7节"skip_on_gaps参数设置建议"，提供详细的参数设置指导：
  - **参数作用详解**: 明确false（补零合并）和true（跳过间断）两种模式的工作原理
  - **应用场景分析**: 详细说明何时使用false模式（数据间断少、长期监测、标准方法）和true模式（间断频繁、高精度分析、仪器评估）
  - **实际应用策略**: 提供初步分析、数据质量评估、对比验证、文档记录的完整工作流程
  - **特殊考虑因素**: 涵盖计算效率、统计稳定性、频率依赖性、台站特性等实际应用中的重要考虑

- **2025-05-27**: 文档结构优化 - 将"skip_on_gaps参数设置建议"从"6. 常见问题与解决方案"移动到"7. 最佳实践"章节：
  - **结构调整**: 将6.7节内容移动为7.3节"skip_on_gaps参数设置最佳实践"
  - **逻辑优化**: 将参数设置指导归类为最佳实践，更符合内容性质
  - **章节重编号**: 原7.3节"结果验证与解读"调整为7.4节
  - **内容保持**: 所有技术内容和指导建议完全保持不变

- **2025-05-27**: skip_on_gaps参数极端情况处理补充 - 在7.3节"skip_on_gaps参数设置最佳实践"中新增E小节"极端情况处理"：
  - **问题识别**: 详细描述数据间断过多导致skip_on_gaps=true无法生成PPSD的问题表现
  - **判断标准**: 提供数据间断占比、连续数据段长度等具体的判断标准
  - **解决策略**: 提供5种系统性的解决方案，包括参数降级、窗口调整、时间筛选、数据预处理、分析要求调整
  - **预防措施**: 建立数据质量评估和备用分析策略的预防性措施
  - **分层分析**: 提出"分层分析"策略，为不同数据质量等级提供系统性的处理方案
